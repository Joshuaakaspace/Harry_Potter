<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Harry Potter 3D Spell Quiz - 10 Levels</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            font-family: 'Georgia', serif;
            overflow: hidden;
            background: #000;
        }
        
        #gameContainer {
            position: relative;
            width: 100vw;
            height: 100vh;
        }
        
        #ui {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 10;
        }
        
        #stats {
            position: absolute;
            top: 20px;
            left: 20px;
            color: #FFD700;
            font-size: 20px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.8);
            background: rgba(0,0,0,0.5);
            padding: 15px;
            border-radius: 10px;
            border: 2px solid #FFD700;
        }
        
        #progressBar {
            position: absolute;
            top: 20px;
            right: 20px;
            width: 300px;
            height: 30px;
            background: rgba(0,0,0,0.5);
            border: 2px solid #FFD700;
            border-radius: 15px;
            overflow: hidden;
        }
        
        #progressFill {
            height: 100%;
            background: linear-gradient(90deg, #FFD700, #FFA500);
            width: 0%;
            transition: width 0.5s ease;
        }
        
        #progressText {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: white;
            font-weight: bold;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.8);
        }
        
        #questionBox {
            position: absolute;
            bottom: 100px;
            left: 50%;
            transform: translateX(-50%);
            width: 80%;
            max-width: 600px;
            background: linear-gradient(135deg, rgba(26,0,51,0.9), rgba(77,0,153,0.9));
            border: 3px solid #FFD700;
            border-radius: 15px;
            padding: 20px;
            color: white;
            text-align: center;
            pointer-events: auto;
            box-shadow: 0 0 30px rgba(255,215,0,0.5);
        }
        
        #levelName {
            font-size: 16px;
            color: #FFA500;
            margin-bottom: 10px;
            text-transform: uppercase;
            letter-spacing: 2px;
        }
        
        #question {
            font-size: 24px;
            margin-bottom: 20px;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.8);
        }
        
        .answer {
            background: linear-gradient(135deg, #2C1810, #4A2C17);
            border: 2px solid #8B4513;
            color: #FFD700;
            padding: 15px;
            margin: 10px;
            border-radius: 10px;
            cursor: pointer;
            font-size: 18px;
            transition: all 0.3s;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.8);
        }
        
        .answer:hover {
            background: linear-gradient(135deg, #4A2C17, #6B3410);
            transform: scale(1.05);
            box-shadow: 0 0 20px rgba(255,215,0,0.5);
        }
        
        .answer.disabled {
            pointer-events: none;
            opacity: 0.6;
        }
        
        #spellEffect {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 60px;
            color: #FFD700;
            text-shadow: 0 0 30px #FFD700;
            opacity: 0;
            pointer-events: none;
            font-weight: bold;
        }
        
        #levelComplete {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: linear-gradient(135deg, rgba(26,0,51,0.95), rgba(77,0,153,0.95));
            border: 3px solid #FFD700;
            border-radius: 20px;
            padding: 40px;
            color: white;
            text-align: center;
            display: none;
            pointer-events: auto;
            box-shadow: 0 0 50px rgba(255,215,0,0.8);
            max-width: 500px;
        }
        
        #levelComplete h2 {
            color: #FFD700;
            font-size: 36px;
            margin-bottom: 20px;
        }
        
        .nextButton {
            background: linear-gradient(135deg, #FFD700, #FFA500);
            color: #1A0033;
            border: none;
            padding: 15px 30px;
            font-size: 20px;
            border-radius: 10px;
            cursor: pointer;
            font-weight: bold;
            margin-top: 20px;
            transition: all 0.3s;
        }
        
        .nextButton:hover {
            transform: scale(1.1);
            box-shadow: 0 0 30px rgba(255,215,0,0.8);
        }
        
        #gameOver {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: linear-gradient(135deg, rgba(26,0,51,0.95), rgba(77,0,153,0.95));
            border: 3px solid #FFD700;
            border-radius: 20px;
            padding: 40px;
            color: white;
            text-align: center;
            display: none;
            pointer-events: auto;
            box-shadow: 0 0 50px rgba(255,215,0,0.8);
            max-width: 600px;
        }
        
        #startScreen {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: linear-gradient(135deg, rgba(26,0,51,0.95), rgba(77,0,153,0.95));
            border: 3px solid #FFD700;
            border-radius: 20px;
            padding: 40px;
            color: white;
            text-align: center;
            pointer-events: auto;
            box-shadow: 0 0 50px rgba(255,215,0,0.8);
            max-width: 600px;
        }
        
        #startScreen h1 {
            color: #FFD700;
            font-size: 42px;
            margin-bottom: 20px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.8);
        }
    </style>
</head>
<body>
    <div id="gameContainer">
        <div id="ui">
            <div id="stats">
                <div>Level: <span id="level">1</span>/10</div>
                <div>Question: <span id="questionNumber">1</span>/10</div>
                <div>Score: <span id="score">0</span></div>
                <div>House Points: <span id="points">0</span></div>
            </div>
            
            <div id="progressBar">
                <div id="progressFill"></div>
                <div id="progressText">0/100</div>
            </div>
            
            <div id="startScreen">
                <h1>Harry Potter 3D Spell Quiz</h1>
                <p style="font-size: 20px; margin: 20px 0;">Test your knowledge of the Wizarding World!</p>
                <p style="font-size: 18px; margin: 20px 0;">10 Levels • 100 Questions • Magical Rewards</p>
                <button class="nextButton" onclick="startGame()">Begin Your Journey</button>
            </div>
            
            <div id="questionBox" style="display: none;">
                <div id="levelName"></div>
                <div id="question"></div>
                <div id="answers"></div>
            </div>
            
            <div id="spellEffect"></div>
            
            <div id="levelComplete">
                <h2>Level Complete!</h2>
                <div id="levelStats"></div>
                <button class="nextButton" onclick="nextLevel()">Continue to Next Level</button>
            </div>
            
            <div id="gameOver">
                <h2 style="color: #FFD700; font-size: 36px;">Congratulations!</h2>
                <div id="finalStats"></div>
                <button class="nextButton" onclick="location.reload()">Play Again</button>
            </div>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script>
        // Game state
        let currentLevel = 1;
        let score = 0;
        let housePoints = 0;
        let currentQuestionIndex = 0;
        let correctAnswers = 0;
        let totalQuestionsAnswered = 0;
        let levelCorrectAnswers = 0;
        let answering = false;
        
        // Questions for each level
        const levels = {
            1: {
                name: "First Year Charms",
                questions: [
                    {
                        question: "What spell creates light at the tip of your wand?",
                        answers: ["Lumos", "Nox", "Incendio", "Alohomora"],
                        correct: 0,
                        spell: "Lumos!"
                    },
                    {
                        question: "Which spell unlocks doors?",
                        answers: ["Expelliarmus", "Alohomora", "Wingardium Leviosa", "Accio"],
                        correct: 1,
                        spell: "Alohomora!"
                    },
                    {
                        question: "What is the levitation charm?",
                        answers: ["Protego", "Stupefy", "Wingardium Leviosa", "Reparo"],
                        correct: 2,
                        spell: "Wingardium Leviosa!"
                    },
                    {
                        question: "Which spell repairs broken objects?",
                        answers: ["Reparo", "Diffindo", "Reducto", "Finite"],
                        correct: 0,
                        spell: "Reparo!"
                    },
                    {
                        question: "What spell extinguishes light from Lumos?",
                        answers: ["Knox", "Nox", "Finite", "Obscuro"],
                        correct: 1,
                        spell: "Nox!"
                    },
                    {
                        question: "Which spell makes objects fly to you?",
                        answers: ["Depulso", "Wingardium Leviosa", "Accio", "Locomotor"],
                        correct: 2,
                        spell: "Accio!"
                    },
                    {
                        question: "What charm makes things stick together?",
                        answers: ["Permanent Sticking Charm", "Glisseo", "Colloportus", "Adhesio"],
                        correct: 0,
                        spell: "Permanent Sticking!"
                    },
                    {
                        question: "Which spell tickles the target?",
                        answers: ["Tarantallegra", "Rictusempra", "Locomotor Mortis", "Petrificus"],
                        correct: 1,
                        spell: "Rictusempra!"
                    },
                    {
                        question: "What spell locks doors?",
                        answers: ["Alohomora", "Colloportus", "Protego", "Impedimenta"],
                        correct: 1,
                        spell: "Colloportus!"
                    },
                    {
                        question: "Which spell creates a small flame?",
                        answers: ["Lumos", "Flagrate", "Incendio", "Confringo"],
                        correct: 2,
                        spell: "Incendio!"
                    }
                ]
            },
            2: {
                name: "Defense Against Dark Arts",
                questions: [
                    {
                        question: "What spell disarms an opponent?",
                        answers: ["Expelliarmus", "Stupefy", "Protego", "Impedimenta"],
                        correct: 0,
                        spell: "Expelliarmus!"
                    },
                    {
                        question: "Which spell creates a shield charm?",
                        answers: ["Riddikulus", "Protego", "Expecto Patronum", "Finite Incantatem"],
                        correct: 1,
                        spell: "Protego!"
                    },
                    {
                        question: "What spell repels Dementors?",
                        answers: ["Lumos Maxima", "Riddikulus", "Expecto Patronum", "Stupefy"],
                        correct: 2,
                        spell: "Expecto Patronum!"
                    },
                    {
                        question: "Which spell stuns opponents?",
                        answers: ["Expelliarmus", "Stupefy", "Petrificus Totalus", "Impedimenta"],
                        correct: 1,
                        spell: "Stupefy!"
                    },
                    {
                        question: "What spell defeats a Boggart?",
                        answers: ["Expecto Patronum", "Stupefy", "Riddikulus", "Finite"],
                        correct: 2,
                        spell: "Riddikulus!"
                    },
                    {
                        question: "Which spell slows down a target?",
                        answers: ["Impedimenta", "Locomotor Mortis", "Petrificus", "Immobilus"],
                        correct: 0,
                        spell: "Impedimenta!"
                    },
                    {
                        question: "What spell freezes the target in place?",
                        answers: ["Stupefy", "Immobilus", "Petrificus Totalus", "Glacius"],
                        correct: 1,
                        spell: "Immobilus!"
                    },
                    {
                        question: "Which spell creates a corporeal Patronus?",
                        answers: ["Expecto Patronum", "Protego Maxima", "Lumos Solem", "Fidelius"],
                        correct: 0,
                        spell: "Expecto Patronum!"
                    },
                    {
                        question: "What hex gives the target jelly-legs?",
                        answers: ["Tarantallegra", "Locomotor Mortis", "Jelly-Legs Jinx", "Levicorpus"],
                        correct: 2,
                        spell: "Locomotor Wibbly!"
                    },
                    {
                        question: "Which spell creates a full body-bind?",
                        answers: ["Stupefy", "Impedimenta", "Locomotor Mortis", "Petrificus Totalus"],
                        correct: 3,
                        spell: "Petrificus Totalus!"
                    }
                ]
            },
            3: {
                name: "Transfiguration",
                questions: [
                    {
                        question: "What spell transforms objects into birds?",
                        answers: ["Avifors", "Avis", "Ornithis", "Volatilus"],
                        correct: 0,
                        spell: "Avifors!"
                    },
                    {
                        question: "Which spell turns vinegar into wine?",
                        answers: ["Aguamenti", "Vinum", "Transfiguro", "Vinumus"],
                        correct: 1,
                        spell: "Vinum!"
                    },
                    {
                        question: "What spell vanishes objects?",
                        answers: ["Deletrius", "Evanesco", "Finite", "Vanishio"],
                        correct: 1,
                        spell: "Evanesco!"
                    },
                    {
                        question: "Which spell creates birds from thin air?",
                        answers: ["Avifors", "Avis", "Serpensortia", "Aparecium"],
                        correct: 1,
                        spell: "Avis!"
                    },
                    {
                        question: "What spell turns small objects into rabbits?",
                        answers: ["Lepifors", "Lapifors", "Cuniculifors", "Lepusfors"],
                        correct: 1,
                        spell: "Lapifors!"
                    },
                    {
                        question: "Which spell creates a snake?",
                        answers: ["Vipera", "Serpensortia", "Ophidius", "Snakius"],
                        correct: 1,
                        spell: "Serpensortia!"
                    },
                    {
                        question: "What spell turns animals into water goblets?",
                        answers: ["Vera Verto", "Aqua Verto", "Gobletius", "Calicio"],
                        correct: 0,
                        spell: "Vera Verto!"
                    },
                    {
                        question: "Which spell conjures a flock of canaries?",
                        answers: ["Avis", "Canarius", "Avifors", "Flockius"],
                        correct: 0,
                        spell: "Avis!"
                    },
                    {
                        question: "What spell changes the color of objects?",
                        answers: ["Colovaria", "Colorius", "Chromatius", "Tinctorius"],
                        correct: 0,
                        spell: "Colovaria!"
                    },
                    {
                        question: "Which spell transforms a desk into a pig?",
                        answers: ["Porcifors", "Deskius Porcus", "Suillifors", "Piggifors"],
                        correct: 2,
                        spell: "Suillifors!"
                    }
                ]
            },
            4: {
                name: "Potions & Herbology",
                questions: [
                    {
                        question: "What spell makes plants grow rapidly?",
                        answers: ["Herbivicus", "Planticus", "Growthius", "Florarius"],
                        correct: 0,
                        spell: "Herbivicus!"
                    },
                    {
                        question: "Which potion ingredient requires a Full Moon to pick?",
                        answers: ["Wolfsbane", "Moonstone", "Fluxweed", "Silverweed"],
                        correct: 2,
                        spell: "Fluxweed Located!"
                    },
                    {
                        question: "What spell prunes plants?",
                        answers: ["Diffindo", "Severing Charm", "Prunius", "Both A and B"],
                        correct: 3,
                        spell: "Diffindo!"
                    },
                    {
                        question: "Which spell revives someone who has been Stunned?",
                        answers: ["Episkey", "Rennervate", "Finite", "Revivio"],
                        correct: 1,
                        spell: "Rennervate!"
                    },
                    {
                        question: "What plant screams when uprooted?",
                        answers: ["Venomous Tentacula", "Mandrake", "Screechsnap", "Howler Root"],
                        correct: 1,
                        spell: "Silencio Required!"
                    },
                    {
                        question: "Which spell extracts memories?",
                        answers: ["Memorius", "Legilimens", "Obliviate", "None, it's done manually"],
                        correct: 3,
                        spell: "Memory Extracted!"
                    },
                    {
                        question: "What spell identifies potion ingredients?",
                        answers: ["Specialis Revelio", "Aparecium", "Revelio", "Scarpin's Revelaspell"],
                        correct: 0,
                        spell: "Specialis Revelio!"
                    },
                    {
                        question: "Which plant's leaves are used in Pepperup Potion?",
                        answers: ["Peppermint", "Mandrake", "Dittany", "Ginger"],
                        correct: 0,
                        spell: "Ingredient Found!"
                    },
                    {
                        question: "What spell cleans cauldrons?",
                        answers: ["Tergeo", "Scourgify", "Evanesco", "Mundius"],
                        correct: 1,
                        spell: "Scourgify!"
                    },
                    {
                        question: "Which magical plant can strangle you?",
                        answers: ["Whomping Willow", "Devil's Snare", "Venomous Tentacula", "Strangler Fig"],
                        correct: 1,
                        spell: "Lumos Solem!"
                    }
                ]
            },
            5: {
                name: "Advanced Charms",
                questions: [
                    {
                        question: "What spell creates water?",
                        answers: ["Aquamenti", "Aguamenti", "Aquarius", "Hydrous"],
                        correct: 1,
                        spell: "Aguamenti!"
                    },
                    {
                        question: "Which spell creates a protective enchantment around a dwelling?",
                        answers: ["Protego Totalum", "Fidelius Charm", "Cave Inimicum", "Salvio Hexia"],
                        correct: 1,
                        spell: "Fidelius!"
                    },
                    {
                        question: "What spell duplicates objects?",
                        answers: ["Duplicato", "Geminio", "Doublius", "Copyus"],
                        correct: 1,
                        spell: "Geminio!"
                    },
                    {
                        question: "Which spell makes things larger?",
                        answers: ["Engorgio", "Amplificato", "Magnificus", "Expandius"],
                        correct: 0,
                        spell: "Engorgio!"
                    },
                    {
                        question: "What spell makes things smaller?",
                        answers: ["Diminuendo", "Reducio", "Minimus", "Contracto"],
                        correct: 1,
                        spell: "Reducio!"
                    },
                    {
                        question: "Which spell creates a Portkey?",
                        answers: ["Portus", "Portkey", "Transporto", "Teleportus"],
                        correct: 0,
                        spell: "Portus!"
                    },
                    {
                        question: "What spell reveals hidden messages?",
                        answers: ["Revelio", "Aparecium", "Specialis Revelio", "Manifestus"],
                        correct: 1,
                        spell: "Aparecium!"
                    },
                    {
                        question: "Which spell creates solid light?",
                        answers: ["Lumos Maxima", "Lumos Solem", "Solarius", "Luminous"],
                        correct: 1,
                        spell: "Lumos Solem!"
                    },
                    {
                        question: "What spell removes tracking spells?",
                        answers: ["Finite", "Cave Inimicum", "Deletrius", "Liberatus"],
                        correct: 2,
                        spell: "Deletrius!"
                    },
                    {
                        question: "Which spell creates an unbreakable vow?",
                        answers: ["Unbreakable Vow", "Perpetuus", "Vowius", "It's a ritual, not a spell"],
                        correct: 3,
                        spell: "Vow Created!"
                    }
                ]
            },
            6: {
                name: "Hexes and Jinxes",
                questions: [
                    {
                        question: "What hex causes uncontrollable dancing?",
                        answers: ["Tarantallegra", "Locomotor", "Dancio", "Saltatio"],
                        correct: 0,
                        spell: "Tarantallegra!"
                    },
                    {
                        question: "Which jinx causes boils?",
                        answers: ["Furunculus", "Boilius", "Pustulus", "Eruptio"],
                        correct: 0,
                        spell: "Furunculus!"
                    },
                    {
                        question: "What hex hangs someone upside down?",
                        answers: ["Levicorpus", "Suspendius", "Invertio", "Hangius"],
                        correct: 0,
                        spell: "Levicorpus!"
                    },
                    {
                        question: "Which counter-jinx releases someone from Levicorpus?",
                        answers: ["Finite", "Liberacorpus", "Relashio", "Descendo"],
                        correct: 1,
                        spell: "Liberacorpus!"
                    },
                    {
                        question: "What jinx makes the target's teeth grow rapidly?",
                        answers: ["Dentisaugeo", "Densaugeo", "Teethius", "Growthio"],
                        correct: 1,
                        spell: "Densaugeo!"
                    },
                    {
                        question: "Which hex causes the tongue to stick to the roof of the mouth?",
                        answers: ["Silencio", "Langlock", "Muffliato", "Quietus"],
                        correct: 1,
                        spell: "Langlock!"
                    },
                    {
                        question: "What jinx trips people?",
                        answers: ["Locomotor Mortis", "Trip Jinx", "Impedimenta", "Colloportus"],
                        correct: 1,
                        spell: "Trip Jinx!"
                    },
                    {
                        question: "Which hex causes painful stinging?",
                        answers: ["Stinging Hex", "Dolorus", "Crucio", "Punctius"],
                        correct: 0,
                        spell: "Stinging Hex!"
                    },
                    {
                        question: "What jinx makes objects attack their owner?",
                        answers: ["Oppugno", "Attackius", "Rebellio", "Turncoat"],
                        correct: 0,
                        spell: "Oppugno!"
                    },
                    {
                        question: "Which hex fills ears with buzzing?",
                        answers: ["Buzzius", "Muffliato", "Tinnitus", "Aurius"],
                        correct: 1,
                        spell: "Muffliato!"
                    }
                ]
            },
            7: {
                name: "Magical Creatures",
                questions: [
                    {
                        question: "What spell repels spiders?",
                        answers: ["Arania Exumai", "Arachnius Repello", "Spiderus Away", "Repello Arachnid"],
                        correct: 0,
                        spell: "Arania Exumai!"
                    },
                    {
                        question: "Which spell is effective against Grindylows?",
                        answers: ["Stupefy", "Relashio", "Impedimenta", "Aqua Eructo"],
                        correct: 1,
                        spell: "Relashio!"
                    },
                    {
                        question: "What spell conjures the Dark Mark?",
                        answers: ["Morsmordre", "Dark Markius", "Mortis Signum", "Voldemortius"],
                        correct: 0,
                        spell: "Morsmordre!"
                    },
                    {
                        question: "Which spell summons creatures?",
                        answers: ["Accio Creature", "Piertotum Locomotor", "Animagus", "Creature Call"],
                        correct: 1,
                        spell: "Piertotum Locomotor!"
                    },
                    {
                        question: "What spell transforms into an animal form?",
                        answers: ["Animagus", "Transfiguro", "Beastius", "It's not a spell"],
                        correct: 3,
                        spell: "Animagus Transformation!"
                    },
                    {
                        question: "Which spell is used to control Inferi?",
                        answers: ["Imperio", "Necromantius", "Fire spells", "Morsmordre"],
                        correct: 2,
                        spell: "Incendio!"
                    },
                    {
                        question: "What spell repels Doxies?",
                        answers: ["Doxycide", "Flipendo", "Stupefy", "Immobilus"],
                        correct: 1,
                        spell: "Flipendo!"
                    },
                    {
                        question: "Which spell is effective against werewolves?",
                        answers: ["Silver spells", "Stupefy", "Lumos", "Homorphus Charm"],
                        correct: 3,
                        spell: "Homorphus!"
                    },
                    {
                        question: "What spell calms creatures?",
                        answers: ["Calmius", "Immobilus", "Peaceful Charm", "Tranquillo"],
                        correct: 1,
                        spell: "Immobilus!"
                    },
                    {
                        question: "Which spell reveals Animagi?",
                        answers: ["Homenum Revelio", "Animagus Revelio", "Specialis Revelio", "Revelio Animagus"],
                        correct: 0,
                        spell: "Homenum Revelio!"
                    }
                ]
            },
            8: {
                name: "Dark Arts",
                questions: [
                    {
                        question: "Which Unforgivable Curse causes unbearable pain?",
                        answers: ["Imperio", "Crucio", "Avada Kedavra", "Sectumsempra"],
                        correct: 1,
                        spell: "Crucio!"
                    },
                    {
                        question: "What spell creates deep cuts?",
                        answers: ["Diffindo", "Sectumsempra", "Confringo", "Lacero"],
                        correct: 1,
                        spell: "Sectumsempra!"
                    },
                    {
                        question: "Which curse kills instantly?",
                        answers: ["Crucio", "Imperio", "Avada Kedavra", "Mortis"],
                        correct: 2,
                        spell: "Avada Kedavra!"
                    },
                    {
                        question: "What spell controls minds?",
                        answers: ["Confundus", "Imperio", "Obliviate", "Legilimens"],
                        correct: 1,
                        spell: "Imperio!"
                    },
                    {
                        question: "Which spell causes explosions?",
                        answers: ["Bombarda", "Confringo", "Expulso", "All of the above"],
                        correct: 3,
                        spell: "Confringo!"
                    },
                    {
                        question: "What is the incantation for Fiendfyre?",
                        answers: ["Fiendfyre", "Infernius", "No specific incantation", "Ignis Diabolica"],
                        correct: 2,
                        spell: "Fiendfyre!"
                    },
                    {
                        question: "Which spell creates cursed fire?",
                        answers: ["Incendio", "Fiendfyre", "Flagrante", "Protego Diabolica"],
                        correct: 1,
                        spell: "Fiendfyre!"
                    },
                    {
                        question: "What counter-curse heals Sectumsempra?",
                        answers: ["Episkey", "Vulnera Sanentur", "Rennervate", "Tergeo"],
                        correct: 1,
                        spell: "Vulnera Sanentur!"
                    },
                    {
                        question: "Which spell creates a wall of black fire?",
                        answers: ["Fiendfyre", "Protego Diabolica", "Ignis Niger", "Infernius"],
                        correct: 1,
                        spell: "Protego Diabolica!"
                    },
                    {
                        question: "What spell extracts memories by force?",
                        answers: ["Obliviate", "Imperio", "Legilimens", "Memorius"],
                        correct: 2,
                        spell: "Legilimens!"
                    }
                ]
            },
            9: {
                name: "Ancient Magic",
                questions: [
                    {
                        question: "What spell creates an age line?",
                        answers: ["Age Line", "Temporus Limitus", "Aetas Linea", "It's a potion"],
                        correct: 0,
                        spell: "Age Line!"
                    },
                    {
                        question: "Which spell requires a Secret Keeper?",
                        answers: ["Unbreakable Vow", "Fidelius Charm", "Protego Maxima", "Secret Spell"],
                        correct: 1,
                        spell: "Fidelius!"
                    },
                    {
                        question: "What ancient spell protects through love?",
                        answers: ["Amor Protego", "Love Shield", "Sacrificial Protection", "Protego Amore"],
                        correct: 2,
                        spell: "Love's Protection!"
                    },
                    {
                        question: "Which spell animates statues?",
                        answers: ["Piertotum Locomotor", "Statua Animatus", "Locomotor Statue", "Vivify"],
                        correct: 0,
                        spell: "Piertotum Locomotor!"
                    },
                    {
                        question: "What spell creates protective enchantments?",
                        answers: ["Cave Inimicum", "Protego Totalum", "Salvio Hexia", "All of the above"],
                        correct: 3,
                        spell: "Protection Cast!"
                    },
                    {
                        question: "Which ancient spell requires blood?",
                        answers: ["Blood Pact", "Unbreakable Vow", "Fidelius Charm", "Horcrux Creation"],
                        correct: 0,
                        spell: "Blood Magic!"
                    },
                    {
                        question: "What spell reveals magical traces?",
                        answers: ["Prior Incantato", "Specialis Revelio", "Priori Incantatem", "Revelio Magicus"],
                        correct: 2,
                        spell: "Priori Incantatem!"
                    },
                    {
                        question: "Which spell creates Horcruxes?",
                        answers: ["Avada Kedavra", "Soul Split", "No specific spell", "Horcruxius"],
                        correct: 2,
                        spell: "Dark Magic!"
                    },
                    {
                        question: "What charm makes objects unplottable?",
                        answers: ["Unplottable Charm", "Cave Locatum", "Mappa Negatus", "Hidden Charm"],
                        correct: 0,
                        spell: "Unplottable!"
                    },
                    {
                        question: "Which spell creates perpetual protection?",
                        answers: ["Protego Infinitus", "Perpetual Charm", "Protego Semper", "Ancient Runes"],
                        correct: 3,
                        spell: "Rune Magic!"
                    }
                ]
            },
            10: {
                name: "Mastery Examination",
                questions: [
                    {
                        question: "What is the most powerful defensive charm?",
                        answers: ["Protego", "Protego Maxima", "Protego Totalum", "Protego Horribilis"],
                        correct: 3,
                        spell: "Protego Horribilis!"
                    },
                    {
                        question: "Which spell did Hermione use to modify her parents' memories?",
                        answers: ["Obliviate", "Confundus", "Memory Charm", "False Memory Charm"],
                        correct: 0,
                        spell: "Obliviate!"
                    },
                    {
                        question: "What spell created the Deluminator?",
                        answers: ["Lumos Capture", "Light Thief", "Unknown", "Deluminatus"],
                        correct: 2,
                        spell: "Unknown Magic!"
                    },
                    {
                        question: "Which spell can destroy a Horcrux?",
                        answers: ["Avada Kedavra", "Fiendfyre", "Basilisk Venom", "B and C"],
                        correct: 3,
                        spell: "Horcrux Destroyed!"
                    },
                    {
                        question: "What is Voldemort's signature spell?",
                        answers: ["Crucio", "Imperio", "Avada Kedavra", "Morsmordre"],
                        correct: 2,
                        spell: "The Killing Curse!"
                    },
                    {
                        question: "Which spell did Snape create?",
                        answers: ["Sectumsempra", "Levicorpus", "Muffliato", "All of the above"],
                        correct: 3,
                        spell: "Half-Blood Prince!"
                    },
                    {
                        question: "What spell opens the Chamber of Secrets?",
                        answers: ["Alohomora", "Open Sesame", "Parseltongue", "Serpensortia"],
                        correct: 2,
                        spell: "Speak to me, Slytherin!"
                    },
                    {
                        question: "Which spell summons the Knight Bus?",
                        answers: ["Accio Bus", "Knight Summon", "Wand Raised", "Erecto"],
                        correct: 2,
                        spell: "Knight Bus!"
                    },
                    {
                        question: "What creates a corporeal Patronus?",
                        answers: ["Happy memory", "Strong emotion", "Pure heart", "Powerful magic"],
                        correct: 0,
                        spell: "Expecto Patronum!"
                    },
                    {
                        question: "Which spell defeated Voldemort?",
                        answers: ["Avada Kedavra", "Expelliarmus", "Love", "Elder Wand's allegiance"],
                        correct: 1,
                        spell: "Expelliarmus!"
                    }
                ]
            }
        };
        
        // Three.js setup
        let scene, camera, renderer;
        let wand, spellParticles = [];
        let starField;
        
        function initThree() {
            scene = new THREE.Scene();
            scene.fog = new THREE.Fog(0x000033, 1, 50);
            
            camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
            camera.position.z = 5;
            
            renderer = new THREE.WebGLRenderer({ antialias: true });
            renderer.setSize(window.innerWidth, window.innerHeight);
            renderer.shadowMap.enabled = true;
            document.getElementById('gameContainer').appendChild(renderer.domElement);
            
            // Lighting
            const ambientLight = new THREE.AmbientLight(0x404040);
            scene.add(ambientLight);
            
            const pointLight = new THREE.PointLight(0xFFD700, 1, 100);
            pointLight.position.set(0, 5, 5);
            scene.add(pointLight);
            
            // Create wand
            const wandGeometry = new THREE.CylinderGeometry(0.05, 0.03, 2, 8);
            const wandMaterial = new THREE.MeshPhongMaterial({ 
                color: 0x8B4513,
                emissive: 0x4A2A00,
                shininess: 100
            });
            wand = new THREE.Mesh(wandGeometry, wandMaterial);
            wand.position.set(0, -1, 0);
            wand.rotation.z = Math.PI / 4;
            scene.add(wand);
            
            // Add wand tip glow
            const glowGeometry = new THREE.SphereGeometry(0.1, 16, 16);
            const glowMaterial = new THREE.MeshBasicMaterial({
                color: 0xFFD700,
                transparent: true,
                opacity: 0.3
            });
            const wandGlow = new THREE.Mesh(glowGeometry, glowMaterial);
            wandGlow.position.set(0.7, 0.7, 0);
            wand.add(wandGlow);
            
            // Create magical background
            createMagicalBackground();
            
            animate();
        }
        
        function createMagicalBackground() {
            const starGeometry = new THREE.BufferGeometry();
            const starCount = 2000;
            const positions = new Float32Array(starCount * 3);
            const colors = new Float32Array(starCount * 3);
            
            for (let i = 0; i < starCount * 3; i += 3) {
                positions[i] = (Math.random() - 0.5) * 100;
                positions[i + 1] = (Math.random() - 0.5) * 100;
                positions[i + 2] = (Math.random() - 0.5) * 100;
                
                // Add some color variation
                const brightness = Math.random();
                colors[i] = brightness;
                colors[i + 1] = brightness * 0.8;
                colors[i + 2] = brightness * 0.6;
            }
            
            starGeometry.setAttribute('position', new THREE.BufferAttribute(positions, 3));
            starGeometry.setAttribute('color', new THREE.BufferAttribute(colors, 3));
            
            const starMaterial = new THREE.PointsMaterial({ 
                size: 0.2,
                vertexColors: true,
                transparent: true,
                opacity: 0.8
            });
            
            starField = new THREE.Points(starGeometry, starMaterial);
            scene.add(starField);
        }
        
        function createSpellEffect(color = 0xFFD700) {
            const particleCount = 100;
            for (let i = 0; i < particleCount; i++) {
                const geometry = new THREE.SphereGeometry(0.05, 8, 8);
                const material = new THREE.MeshBasicMaterial({ 
                    color: color,
                    transparent: true,
                    opacity: 0.8,
                    emissive: color,
                    emissiveIntensity: 0.5
                });
                const particle = new THREE.Mesh(geometry, material);
                
                const angle = (i / particleCount) * Math.PI * 2;
                const radius = Math.random() * 0.5;
                
                particle.position.set(
                    wand.position.x + Math.cos(angle) * radius,
                    wand.position.y + 1,
                    wand.position.z + Math.sin(angle) * radius
                );
                
                particle.velocity = new THREE.Vector3(
                    Math.cos(angle) * 0.1,
                    Math.random() * 0.2 + 0.1,
                    Math.sin(angle) * 0.1
                );
                
                scene.add(particle);
                spellParticles.push(particle);
            }
        }
        
        function updateParticles() {
            for (let i = spellParticles.length - 1; i >= 0; i--) {
                const particle = spellParticles[i];
                particle.position.add(particle.velocity);
                particle.material.opacity -= 0.02;
                particle.scale.multiplyScalar(0.98);
                
                if (particle.material.opacity <= 0) {
                    scene.remove(particle);
                    spellParticles.splice(i, 1);
                }
            }
        }
        
        function animate() {
            requestAnimationFrame(animate);
            
            // Animate wand
            wand.rotation.y += 0.01;
            wand.position.y = -1 + Math.sin(Date.now() * 0.001) * 0.1;
            
            // Rotate star field
            if (starField) {
                starField.rotation.y += 0.0002;
            }
            
            updateParticles();
            
            renderer.render(scene, camera);
        }
        
        function shuffleArray(array) {
            const shuffled = [...array];
            for (let i = shuffled.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [shuffled[i], shuffled[j]] = [shuffled[j], shuffled[i]];
            }
            return shuffled;
        }
        
        let shuffledQuestions = [];
        
        function startGame() {
            document.getElementById('startScreen').style.display = 'none';
            document.getElementById('questionBox').style.display = 'block';
            loadLevel();
        }
        
        function loadLevel() {
            const levelData = levels[currentLevel];
            shuffledQuestions = shuffleArray(levelData.questions);
            currentQuestionIndex = 0;
            levelCorrectAnswers = 0;
            document.getElementById('levelName').textContent = levelData.name;
            loadQuestion();
        }
        
        function loadQuestion() {
            const question = shuffledQuestions[currentQuestionIndex];
            
            document.getElementById('question').textContent = question.question;
            document.getElementById('questionNumber').textContent = currentQuestionIndex + 1;
            const answersDiv = document.getElementById('answers');
            answersDiv.innerHTML = '';
            
            question.answers.forEach((answer, index) => {
                const button = document.createElement('div');
                button.className = 'answer';
                button.textContent = answer;
                button.onclick = () => checkAnswer(index);
                answersDiv.appendChild(button);
            });
            
            answering = false;
        }
        
        function checkAnswer(selectedIndex) {
            if (answering) return;
            answering = true;
            
            const question = shuffledQuestions[currentQuestionIndex];
            const answerButtons = document.querySelectorAll('.answer');
            answerButtons.forEach(btn => btn.classList.add('disabled'));
            
            if (selectedIndex === question.correct) {
                // Correct answer
                correctAnswers++;
                levelCorrectAnswers++;
                score += 100 * currentLevel;
                housePoints += 10 * currentLevel;
                
                // Cast spell effect
                castSpell(question.spell, 0x00FF00);
                createSpellEffect(0x00FF00);
                
                // Animate wand
                gsap.to(wand.rotation, {
                    z: Math.PI * 2.5,
                    duration: 1,
                    onComplete: () => {
                        wand.rotation.z = Math.PI / 4;
                    }
                });
            } else {
                // Wrong answer
                castSpell("Incorrect!", 0xFF0000);
                createSpellEffect(0xFF0000);
            }
            
            totalQuestionsAnswered++;
            updateStats();
            updateProgress();
            
            setTimeout(() => {
                currentQuestionIndex++;
                if (currentQuestionIndex < 10) {
                    loadQuestion();
                } else {
                    showLevelComplete();
                }
            }, 2000);
        }
        
        function castSpell(spellName, color) {
            const spellEffect = document.getElementById('spellEffect');
            spellEffect.textContent = spellName;
            spellEffect.style.color = `#${color.toString(16).padStart(6, '0')}`;
            spellEffect.style.opacity = 1;
            
            setTimeout(() => {
                spellEffect.style.opacity = 0;
            }, 1500);
        }
        
        function updateStats() {
            document.getElementById('score').textContent = score;
            document.getElementById('points').textContent = housePoints;
            document.getElementById('level').textContent = currentLevel;
        }
        
        function updateProgress() {
            const progress = (totalQuestionsAnswered / 100) * 100;
            document.getElementById('progressFill').style.width = progress + '%';
            document.getElementById('progressText').textContent = `${totalQuestionsAnswered}/100`;
        }
        
        function showLevelComplete() {
            const levelComplete = document.getElementById('levelComplete');
            const levelStats = document.getElementById('levelStats');
            
            const accuracy = (levelCorrectAnswers / 10 * 100).toFixed(0);
            
            levelStats.innerHTML = `
                <p style="font-size: 20px;">Level ${currentLevel} - ${levels[currentLevel].name}</p>
                <p style="font-size: 20px;">Correct Answers: ${levelCorrectAnswers}/10 (${accuracy}%)</p>
                <p style="font-size: 20px;">Points Earned: ${100 * currentLevel * levelCorrectAnswers}</p>
                <p style="font-size: 20px;">House Points: ${10 * currentLevel * levelCorrectAnswers}</p>
            `;
            
            levelComplete.style.display = 'block';
        }
        
        function nextLevel() {
            document.getElementById('levelComplete').style.display = 'none';
            currentLevel++;
            
            if (currentLevel > 10) {
                showGameOver();
            } else {
                loadLevel();
                updateStats();
            }
        }
        
        function showGameOver() {
            const gameOver = document.getElementById('gameOver');
            const finalStats = document.getElementById('finalStats');
            
            const accuracy = (correctAnswers / 100 * 100).toFixed(1);
            let grade = "";
            let title = "";
            
            if (score >= 5500) {
                grade = "Outstanding!";
                title = "Master Wizard";
            } else if (score >= 4500) {
                grade = "Exceeds Expectations!";
                title = "Accomplished Wizard";
            } else if (score >= 3500) {
                grade = "Acceptable";
                title = "Qualified Wizard";
            } else if (score >= 2500) {
                grade = "Poor";
                title = "Apprentice Wizard";
            } else {
                grade = "Dreadful";
                title = "Muggle";
            }
            
            finalStats.innerHTML = `
                <p style="font-size: 24px; color: #FFD700;">Final Score: ${score}</p>
                <p style="font-size: 24px; color: #FFD700;">Total House Points: ${housePoints}</p>
                <p style="font-size: 20px; color: #FFA500;">Accuracy: ${accuracy}%</p>
                <p style="font-size: 28px; color: #FFD700; font-weight: bold;">${grade}</p>
                <p style="font-size: 32px; color: #FFD700; font-weight: bold; text-transform: uppercase; letter-spacing: 3px;">${title}</p>
            `;
            
            gameOver.style.display = 'block';
            
            // Celebration effect for high scores
            if (score >= 4500) {
                for (let i = 0; i < 5; i++) {
                    setTimeout(() => createSpellEffect(0xFFD700), i * 200);
                }
            }
        }
        
        // Simplified animation using CSS transitions
        function gsap_to(element, properties) {
            if (properties.z !== undefined) {
                let startZ = element.z;
                let endZ = properties.z;
                let duration = properties.duration * 1000 || 1000;
                let startTime = Date.now();
                
                function animateRotation() {
                    let elapsed = Date.now() - startTime;
                    let progress = Math.min(elapsed / duration, 1);
                    
                    element.z = startZ + (endZ - startZ) * progress;
                    
                    if (progress < 1) {
                        requestAnimationFrame(animateRotation);
                    } else if (properties.onComplete) {
                        properties.onComplete();
                    }
                }
                
                animateRotation();
            }
        }
        
        const gsap = { to: gsap_to };
        
        // Initialize game
        window.onload = function() {
            initThree();
            updateStats();
            updateProgress();
        };
        
        // Handle window resize
        window.addEventListener('resize', () => {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
        });
    </script>
</body>
</html>